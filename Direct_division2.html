<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç›´å¼é™¤æ³•é‹ç®—åš®å° | äº’å‹•æ•¸å­¸å¯¦é©—å®¤</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React æ ¸å¿ƒ (UMD) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js" crossorigin></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"
        crossorigin></script>

    <!-- Lucide Icons (UMD) -->
    <script src="https://unpkg.com/lucide@0.263.1/dist/umd/lucide.min.js"></script>

    <!-- Babel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>

    <!-- Google Fonts: Noto Sans TC -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">

    <!-- Custom Styles -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-5px);
            }

            75% {
                transform: translateX(5px);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes popIn {
            0% {
                transform: scale(0.9);
                opacity: 0;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes confetti {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        .animate-slide-down {
            animation: slideDown 0.3s ease-out forwards;
        }

        .animate-shake {
            animation: shake 0.3s ease-in-out;
        }

        .animate-pop-in {
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #ffd700;
            top: -10px;
            animation: confetti 3s linear infinite;
        }

        /* Strict Grid System for Alignment */
        .division-layout {
            display: flex;
            align-items: flex-start;
            font-family: monospace;
            font-family: 'Noto Sans TC', monospace;
        }

        .main-column {
            display: flex;
            flex-direction: column;
        }

        .number-grid {
            display: grid;
        }

        .cell {
            width: 4rem;
            /* Fixed width */
            height: 4.5rem;
            /* Fixed height */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.875rem;
            /* text-3xl */
            font-weight: 700;
            /* font-bold */
            position: relative;
            color: #1e293b;
            /* slate-800 */
        }

        .grid-input {
            width: 100%;
            height: 80%;
            text-align: center;
            font-size: 1.875rem;
            font-weight: 700;
            border-radius: 0.5rem;
            outline: none;
            background-color: transparent;
            transition: all 0.2s;
            font-family: inherit;
        }

        .grid-input:focus {
            background-color: #e0e7ff;
            /* indigo-100 */
            box-shadow: 0 0 0 2px #6366f1;
            /* indigo-500 */
        }

        .quotient-input {
            border-bottom: 2px solid #6366f1;
            background-color: #f5f3ff;
        }

        /* Strikethrough for intermediate zero remainder */
        .crossed-zero {
            position: relative;
            color: #cbd5e1;
            /* slate-300 */
        }

        .crossed-zero::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 60%;
            height: 2px;
            background-color: #ef4444;
            /* red-500 */
            transform: translate(-50%, -50%) rotate(-45deg);
        }

        /* Certificate Pattern */
        .bg-pattern {
            background-image: radial-gradient(#4f46e5 1px, transparent 1px);
            background-size: 20px 20px;
        }
    </style>
</head>

<body class="bg-slate-50 min-h-screen">

    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef } from 'https://esm.sh/react@18.2.0';
        import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client';
        import {
            CheckCircle2,
            AlertCircle,
            RefreshCcw,
            Trophy,
            ChevronRight,
            Settings,
            Sparkles,
            Divide,
            ArrowDown,
            HelpCircle,
            Eraser,
            Lightbulb,
            BookOpen,
            MousePointerClick,
            Calculator,
            Target,
            Percent,
            Award,
            Star
        } from 'https://esm.sh/lucide-react@0.263.1';

        // --- Constants & Levels ---
        const LEVELS = [
            { divisorDigits: 1, dividendDigits: 2 }, // Level 1
            { divisorDigits: 1, dividendDigits: 3 }, // Level 2
            { divisorDigits: 1, dividendDigits: 4 }, // Level 3
            { divisorDigits: 1, dividendDigits: 5 }, // Level 4
            { divisorDigits: 2, dividendDigits: 3 }, // Level 5
            { divisorDigits: 2, dividendDigits: 4 }, // Level 6
            { divisorDigits: 2, dividendDigits: 5 }, // Level 7
            { divisorDigits: 3, dividendDigits: 4 }, // Level 8
            { divisorDigits: 3, dividendDigits: 5 }  // Level 9 (Final)
        ];

        // --- Helper Component: Instruction Bubble ---
        const InstructionBubble = ({ text, type = 'info', show }) => {
            if (!show) return null;

            const colors = {
                info: 'bg-indigo-600 text-white',
                success: 'bg-green-500 text-white',
                error: 'bg-rose-500 text-white',
                hint: 'bg-amber-500 text-white'
            };

            return (
                <div className={`absolute left-full ml-2 top-1/2 -translate-y-1/2 z-30 whitespace-nowrap animate-fade-in`}>
                    <div className={`relative px-3 py-2 rounded-xl shadow-lg font-bold text-sm ${colors[type]}`}>
                        <div className={`absolute top-1/2 -left-2 -translate-y-1/2 w-0 h-0 border-t-6 border-t-transparent border-r-[8px] border-b-6 border-b-transparent ${type === 'info' ? 'border-r-indigo-600' :
                            type === 'success' ? 'border-r-green-500' :
                                type === 'error' ? 'border-r-rose-500' :
                                    'border-r-amber-500'
                            }`}></div>
                        {text}
                    </div>
                </div>
            );
        };

        // --- Component: Certificate ---
        const Certificate = ({ score, onRestart }) => {
            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in">
                    {/* Confetti Effect */}
                    {Array.from({ length: 20 }).map((_, i) => (
                        <div key={i} className="confetti-piece" style={{
                            left: `${Math.random() * 100}%`,
                            animationDelay: `${Math.random() * 2}s`,
                            backgroundColor: ['#ef4444', '#3b82f6', '#10b981', '#f59e0b'][Math.floor(Math.random() * 4)]
                        }}></div>
                    ))}

                    <div className="bg-white rounded-[2rem] p-2 max-w-2xl w-full shadow-2xl animate-pop-in transform">
                        <div className="border-4 border-double border-indigo-200 rounded-[1.5rem] p-8 md:p-12 flex flex-col items-center text-center bg-pattern relative overflow-hidden">

                            <div className="absolute top-0 left-0 w-24 h-24 bg-gradient-to-br from-yellow-300 to-transparent opacity-50 rounded-br-full"></div>
                            <div className="absolute bottom-0 right-0 w-24 h-24 bg-gradient-to-tl from-indigo-300 to-transparent opacity-50 rounded-tl-full"></div>

                            <div className="mb-6 relative">
                                <div className="absolute inset-0 bg-yellow-200 rounded-full blur-xl opacity-50"></div>
                                <Award size={80} className="text-yellow-500 relative z-10 fill-yellow-100" />
                            </div>

                            <h2 className="text-3xl md:text-4xl font-black text-slate-800 mb-2 tracking-tight">ç›´å¼é™¤æ³•å¤§å¸«è­‰æ›¸</h2>
                            <p className="text-indigo-600 font-bold text-lg mb-8 uppercase tracking-widest">Certificate of Mastery</p>

                            <div className="bg-slate-50 p-6 rounded-2xl border border-slate-100 mb-8 w-full">
                                <p className="text-slate-600 mb-4 text-lg">èŒ²è­‰æ˜</p>
                                <div className="text-2xl font-bold text-slate-800 border-b-2 border-slate-300 pb-2 mb-4 mx-12">
                                    å°å°æ•¸å­¸å®¶
                                </div>
                                <p className="text-slate-600 leading-relaxed">
                                    å·²æˆåŠŸé€šéæ‰€æœ‰é™¤æ³•é‹ç®—è€ƒé©—ï¼Œå±•ç¾äº†å“è¶Šçš„è¨ˆç®—èƒ½åŠ›èˆ‡æ†å¿ƒï¼<br />
                                    æœ€çµ‚å¾—åˆ†ï¼š<span className="text-indigo-600 font-black text-xl">{score}</span>
                                </p>
                            </div>

                            <div className="flex gap-4">
                                <button
                                    onClick={onRestart}
                                    className="px-8 py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 hover:bg-indigo-700 hover:scale-105 transition-all flex items-center gap-2"
                                >
                                    <RefreshCcw size={20} /> å†æ¬¡æŒ‘æˆ°
                                </button>
                            </div>

                            <p className="absolute bottom-4 text-xs text-slate-400 font-mono">
                                {new Date().toLocaleDateString()}
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        // --- Info Cards Component ---
        const InfoCards = () => {
            return (
                <div className="max-w-6xl w-full grid grid-cols-1 md:grid-cols-3 gap-6 mt-12 mb-12">

                    {/* Card 1: Steps */}
                    <div className="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                        <div className="flex items-center gap-3 mb-4 text-indigo-600">
                            <div className="p-2 bg-indigo-50 rounded-xl">
                                <BookOpen size={24} />
                            </div>
                            <h3 className="text-lg font-black">ç›´å¼é™¤æ³•å››éƒ¨æ›²</h3>
                        </div>
                        <ul className="space-y-4 text-sm text-slate-600 font-medium">
                            <li className="flex items-start gap-3">
                                <span className="flex-shrink-0 w-6 h-6 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-xs">1</span>
                                <div>
                                    <span className="font-bold text-slate-800 block">è©¦å•† (Estimate)</span>
                                    æƒ³æƒ³çœ‹ï¼Œè¢«é™¤æ•¸è£¡é¢æœ‰å¹¾å€‹é™¤æ•¸ï¼Ÿ
                                </div>
                            </li>
                            <li className="flex items-start gap-3">
                                <span className="flex-shrink-0 w-6 h-6 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-xs">2</span>
                                <div>
                                    <span className="font-bold text-slate-800 block">ä¹˜æ³• (Multiply)</span>
                                    å•† Ã— é™¤æ•¸ï¼Œç®—å‡ºç©æ˜¯å¤šå°‘ã€‚
                                </div>
                            </li>
                            <li className="flex items-start gap-3">
                                <span className="flex-shrink-0 w-6 h-6 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-xs">3</span>
                                <div>
                                    <span className="font-bold text-slate-800 block">æ¸›æ³• (Subtract)</span>
                                    è¢«é™¤æ•¸ - ç©ï¼Œç®—å‡ºé¤˜æ•¸ (é¤˜æ•¸è¦æ¯”é™¤æ•¸å°)ã€‚
                                </div>
                            </li>
                            <li className="flex items-start gap-3">
                                <span className="flex-shrink-0 w-6 h-6 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-xs">4</span>
                                <div>
                                    <span className="font-bold text-slate-800 block">é™ä½ (Bring Down)</span>
                                    æŠŠä¸‹ä¸€ä½æ•¸å­—æ‹‰ä¸‹ä¾†ï¼Œç¹¼çºŒæŒ‘æˆ°ï¼
                                </div>
                            </li>
                        </ul>
                    </div>

                    {/* Card 2: Tricks */}
                    <div className="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                        <div className="flex items-center gap-3 mb-4 text-amber-500">
                            <div className="p-2 bg-amber-50 rounded-xl">
                                <Lightbulb size={24} />
                            </div>
                            <h3 className="text-lg font-black">è§£é¡Œé«˜æ‰‹ç§˜ç±</h3>
                        </div>
                        <div className="space-y-4 text-sm text-slate-600 font-medium">
                            <div className="bg-amber-50/50 p-3 rounded-xl border border-amber-100">
                                <h4 className="font-bold text-amber-700 mb-1">ğŸ” é€ä½è¼¸å…¥æ³•</h4>
                                <p>ç‚ºäº†æ¨¡æ“¬ç´™ç­†é‹ç®—ï¼Œä¹˜æ³•èˆ‡æ¸›æ³•è«‹å¾ã€Œå€‹ä½ã€é–‹å§‹è¼¸å…¥æ•¸å­—ï¼Œç³»çµ±æœƒè‡ªå‹•å¹«ä½ æª¢æŸ¥å–”ï¼</p>
                            </div>
                            <div className="bg-amber-50/50 p-3 rounded-xl border border-amber-100">
                                <h4 className="font-bold text-amber-700 mb-1">âš¡ å¿«é€Ÿè£œ 0 æ³•</h4>
                                <p>å¦‚æœä¸å¤ é™¤ (å•†æ˜¯ 0)ï¼Œå¯ä»¥ç›´æ¥æŠŠ 0 å¯«ä¸Šå»ï¼Œç„¶å¾Œé¦¬ä¸ŠæŠŠä¸‹ä¸€ä½æ•¸å­—é™ä¸‹ä¾†ï¼</p>
                            </div>
                        </div>
                    </div>

                    {/* Card 3: Guide */}
                    <div className="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                        <div className="flex items-center gap-3 mb-4 text-slate-700">
                            <div className="p-2 bg-slate-100 rounded-xl">
                                <MousePointerClick size={24} />
                            </div>
                            <h3 className="text-lg font-black">ç¨‹å¼ä½¿ç”¨èªªæ˜</h3>
                        </div>
                        <ul className="space-y-4 text-sm text-slate-600 font-medium">
                            <li className="flex items-center gap-3">
                                <Calculator className="text-indigo-500" size={18} />
                                <span>åœ¨ç™¼å…‰çš„æ ¼å­è¼¸å…¥æ•¸å­—ã€‚è©¦å•†èˆ‡é™ä½éœ€æŒ‰ <kbd className="px-1.5 py-0.5 rounded border bg-slate-100 font-mono text-xs">Enter</kbd> ç¢ºèªï¼Œä¹˜æ¸›å‰‡æ˜¯è‡ªå‹•æª¢æŸ¥ã€‚</span>
                            </li>
                            <li className="flex items-center gap-3">
                                <Lightbulb className="text-amber-500" size={18} />
                                <span>å¡é—œäº†å—ï¼Ÿé»æ“Šå³å´é»ƒè‰² <span className="font-bold text-amber-600">æ±‚æ•‘æŒ‰éˆ•</span> ç²å¾—æç¤ºã€‚</span>
                            </li>
                            <li className="flex items-center gap-3">
                                <Target className="text-slate-400" size={18} />
                                <span>é–‹å•Ÿ <span className="font-bold text-indigo-600">è‡ªå‹•é›£åº¦èª¿æ•´</span>ï¼Œ<span className="bg-indigo-100 text-indigo-700 px-1 rounded font-black">é€£å‹ 2 å ´</span> å°±æœƒè‡ªå‹•æ™‰ç´šï¼</span>
                            </li>
                        </ul>
                    </div>

                </div>
            );
        };

        const App = () => {
            // --- Configuration ---
            const [config, setConfig] = useState(LEVELS[0]);
            const [divisor, setDivisor] = useState(3);
            const [dividend, setDividend] = useState(45);
            const [isCleanDivision, setIsCleanDivision] = useState(false);

            // --- Game State ---
            const [phase, setPhase] = useState('QUOTIENT');
            const [currentLevelIdx, setCurrentLevelIdx] = useState(0);
            const [showCertificate, setShowCertificate] = useState(false);

            // Logic State
            const [currentDigitIdx, setCurrentDigitIdx] = useState(0);
            const [workingValue, setWorkingValue] = useState(0);

            // History Rows
            const [historyRows, setHistoryRows] = useState([]);

            // User Inputs
            const [quotientInputs, setQuotientInputs] = useState({});
            const [currentInput, setCurrentInput] = useState('');

            // Step Progress for Multiply/Subtract (Digits entered so far from right to left)
            const [stepProgress, setStepProgress] = useState(0);

            // Feedback & UI
            const [feedback, setFeedback] = useState(null);
            const [score, setScore] = useState(0);
            const [streak, setStreak] = useState(0);
            const [isAutoLevel, setIsAutoLevel] = useState(true);
            const [shakeError, setShakeError] = useState(false);
            const [showHint, setShowHint] = useState(false);

            const inputRef = useRef(null);
            const nextButtonRef = useRef(null);
            const digitInputRef = useRef(null);

            // --- Initialization ---
            useEffect(() => {
                generateProblem();
            }, [config, isCleanDivision]);

            useEffect(() => {
                setShowHint(false);
                setFeedback(null);

                if (phase === 'FINISHED' && nextButtonRef.current) {
                    setTimeout(() => nextButtonRef.current.focus(), 50);
                } else if (inputRef.current) {
                    setTimeout(() => inputRef.current.focus(), 50);
                } else if (digitInputRef.current) {
                    setTimeout(() => digitInputRef.current.focus(), 50);
                }
            }, [phase, currentDigitIdx, historyRows, stepProgress]);

            // --- Helper Functions ---
            const getCurrentHint = () => {
                if (phase === 'QUOTIENT') return `è©¦å•†ï¼š${workingValue} Ã· ${divisor} = ?`;
                if (phase === 'MULTIPLY') return `ä¹˜æ³•ï¼š${divisor} Ã— ${quotientInputs[currentDigitIdx]} (å¾å€‹ä½ç®—èµ·)`;
                if (phase === 'SUBTRACT') return `æ¸›æ³•ï¼šç”±å³å¾€å·¦ç›¸æ¸›`;
                if (phase === 'BRING_DOWN') return `é™ä½ï¼šå°‡ ${dividend.toString()[currentDigitIdx + 1]} å¡«å…¥`;
                return '';
            };

            const getSmartHint = () => {
                if (phase === 'QUOTIENT') {
                    let roundedDivisor = divisor;
                    let roundDesc = "";
                    if (divisor > 10) {
                        const magnitude = Math.pow(10, config.divisorDigits - 1);
                        const leading = Math.round(divisor / magnitude);
                        roundedDivisor = leading * magnitude;
                        roundDesc = `æˆ‘å€‘å¯ä»¥æŠŠ ${divisor} çœ‹ä½œ ${roundedDivisor} ä¾†ä¼°ç®—ã€‚`;
                    }
                    const estQ = Math.max(1, Math.round(workingValue / (roundedDivisor || 1)));
                    return (
                        <div className="space-y-2">
                            <p className="font-bold text-indigo-700 flex items-center gap-2">
                                <Lightbulb size={16} /> ä¼°ç®—å°æŠ€å·§ï¼š
                            </p>
                            <p>{roundDesc}</p>
                            <p>æƒ³æƒ³çœ‹ï¼š<span className="font-bold">{workingValue}</span> è£¡é¢å¤§ç´„æœ‰å¹¾å€‹ <span className="font-bold">{roundedDivisor}</span>ï¼Ÿ</p>
                            <div className="bg-white/50 p-2 rounded border border-indigo-100 mt-2">
                                <p className="text-sm text-slate-600">è©¦è©¦çœ‹ï¼š{roundedDivisor} Ã— {estQ} = {roundedDivisor * estQ}</p>
                                <p className="text-sm font-bold text-indigo-600 mt-1">å»ºè­°å…ˆå¾ {estQ} é–‹å§‹è©¦è©¦çœ‹ï¼</p>
                            </div>
                        </div>
                    );
                }
                return (
                    <div className="space-y-2">
                        <p className="font-bold text-indigo-700">å°æç¤ºï¼š</p>
                        <p>{getCurrentHint()}</p>
                    </div>
                );
            };

            const generateProblem = () => {
                const minDivisor = Math.pow(10, config.divisorDigits - 1);
                const maxDivisor = Math.pow(10, config.divisorDigits) - 1;
                let newDivisor = Math.floor(Math.random() * (maxDivisor - minDivisor + 1)) + minDivisor;

                if (newDivisor < 2 && maxDivisor >= 2) newDivisor = 2;

                const minDividend = Math.pow(10, config.dividendDigits - 1);
                const maxDividend = Math.pow(10, config.dividendDigits) - 1;

                let newDividend;

                if (isCleanDivision) {
                    let tempDividend = Math.floor(Math.random() * (maxDividend - minDividend + 1)) + minDividend;
                    let quotient = Math.floor(tempDividend / newDivisor);
                    if (quotient < 1) quotient = 1;
                    newDividend = quotient * newDivisor;
                    while (newDividend < minDividend) newDividend += newDivisor;
                    while (newDividend > maxDividend && newDividend >= newDivisor * 2) newDividend -= newDivisor;
                    if (newDividend < newDivisor) newDividend = newDivisor * 2;
                } else {
                    newDividend = Math.floor(Math.random() * (maxDividend - minDividend + 1)) + minDividend;
                    if (newDividend < newDivisor) newDividend = newDivisor * (Math.floor(Math.random() * 5) + 1);
                }

                setDivisor(newDivisor);
                setDividend(newDividend);
                resetState(newDividend, newDivisor);
            };

            const resetState = (div, divsr) => {
                const divStr = div.toString();
                let initialIdx = config.divisorDigits - 1;
                let initialVal = parseInt(divStr.substring(0, config.divisorDigits));
                if (initialVal < divsr && divStr.length > config.divisorDigits) {
                    initialIdx++;
                    initialVal = parseInt(divStr.substring(0, initialIdx + 1));
                }
                setWorkingValue(initialVal);
                setCurrentDigitIdx(initialIdx);
                setPhase('QUOTIENT');
                setHistoryRows([]);
                setQuotientInputs({});
                setCurrentInput('');
                setFeedback(null);
                setShowHint(false);
                setStepProgress(0);
            };

            // Transition Logic
            const completePhase = (completedValue) => {
                const divStr = dividend.toString();

                if (phase === 'MULTIPLY') {
                    setHistoryRows(prev => [...prev, {
                        type: 'product',
                        value: completedValue,
                        alignIndex: currentDigitIdx
                    }]);
                    setPhase('SUBTRACT');
                    setStepProgress(0);
                    setCurrentInput('');
                    setFeedback({ type: 'success', text: "ä¹˜æ³•æ­£ç¢ºï¼æ¥ä¸‹ä¾†åšæ¸›æ³•ã€‚" });
                } else if (phase === 'SUBTRACT') {
                    if (currentDigitIdx >= divStr.length - 1) {
                        setHistoryRows(prev => [...prev, {
                            type: 'remainder',
                            value: completedValue,
                            alignIndex: currentDigitIdx,
                            isFinal: true,
                            broughtDown: []
                        }]);
                        setPhase('FINISHED');
                        handleWin();
                        setFeedback({ type: 'success', text: "æ­å–œï¼è¨ˆç®—å®Œæˆã€‚" });
                    } else {
                        setHistoryRows(prev => [...prev, {
                            type: 'remainder',
                            value: completedValue,
                            alignIndex: currentDigitIdx,
                            broughtDown: []
                        }]);
                        setPhase('BRING_DOWN');
                        setFeedback({ type: 'success', text: "æ¸›æ³•æ­£ç¢ºï¼è«‹é™ä¸‹ä¸‹ä¸€ä½æ•¸å­—ã€‚" });
                    }
                    setStepProgress(0);
                    setCurrentInput('');
                }
            };

            // Digit Input Logic for Multiply/Subtract
            const handleDigitInput = (val, expectedDigitStr) => {
                if (!val.match(/^\d$/)) return;

                if (val === expectedDigitStr) {
                    setStepProgress(prev => prev + 1);
                    setShakeError(false);

                    let targetValue = 0;
                    if (phase === 'MULTIPLY') {
                        targetValue = divisor * parseInt(quotientInputs[currentDigitIdx]);
                    } else {
                        const q = parseInt(quotientInputs[currentDigitIdx]);
                        targetValue = workingValue - (divisor * q);
                    }

                    const targetStr = targetValue.toString();
                    if (stepProgress + 1 === targetStr.length) {
                        setTimeout(() => completePhase(targetValue), 200);
                    }
                } else {
                    setShakeError(true);
                    setTimeout(() => setShakeError(false), 500);
                }
            };

            // Standard check for Quotient/BringDown
            const handleCheck = () => {
                let msg = '';
                let isCorrect = false;
                const divStr = dividend.toString();
                setShakeError(false);

                if (phase === 'QUOTIENT') {
                    const correctQ = Math.floor(workingValue / divisor);
                    const userQ = parseInt(quotientInputs[currentDigitIdx] || '');

                    if (isNaN(userQ)) { setShakeError(true); return; }

                    if (userQ === correctQ) {
                        isCorrect = true;

                        if (userQ === 0) {
                            msg = "ä¸å¤ é™¤ï¼Œå•† 0 å¾Œç›´æ¥é™ä¸‹ä¸€ä½ï¼(çœç•¥ä¹˜æ¸›æ­¥é©Ÿ)";
                            if (currentDigitIdx >= divStr.length - 1) {
                                msg = "è¨ˆç®—å®Œæˆï¼æœ€å¾Œå•†è£œ 0ã€‚";
                                setHistoryRows(prev => {
                                    if (prev.length > 0) return prev;
                                    return [...prev, {
                                        type: 'remainder',
                                        value: workingValue,
                                        alignIndex: currentDigitIdx,
                                        isFinal: true,
                                        broughtDown: []
                                    }];
                                });
                                setPhase('FINISHED');
                                handleWin();
                            } else {
                                setPhase('BRING_DOWN');
                            }
                        } else {
                            msg = "å•†æ•¸æ­£ç¢ºï¼ä¸‹ä¸€æ­¥ï¼šè¨ˆç®—ä¹˜ç©";
                            setPhase('MULTIPLY');
                            setStepProgress(0);
                        }
                    } else {
                        setShakeError(true);
                        if (userQ > correctQ) msg = `å¤ªå¤§äº†ï¼ ${divisor} Ã— ${userQ} æœƒè¶…é ${workingValue}`;
                        else msg = `å¤ªå°äº†ï¼ ${workingValue} è£¡é¢é‚„æœ‰æ›´å¤šçš„ ${divisor}`;
                    }
                }
                else if (phase === 'BRING_DOWN') {
                    const nextIdx = currentDigitIdx + 1;
                    const nextDigit = parseInt(divStr[nextIdx]);
                    const userDigit = parseInt(currentInput || '');

                    if (isNaN(userDigit)) { setShakeError(true); return; }

                    if (userDigit === nextDigit) {
                        isCorrect = true;
                        msg = "é™ä½æ­£ç¢ºï¼";

                        setHistoryRows(prev => {
                            const newRows = [...prev];
                            if (newRows.length === 0) return newRows;
                            const lastRowIndex = newRows.length - 1;
                            const lastRow = { ...newRows[lastRowIndex] };
                            if (lastRow.type === 'remainder') {
                                lastRow.broughtDown = [...(lastRow.broughtDown || []), userDigit];
                                newRows[lastRowIndex] = lastRow;
                            }
                            return newRows;
                        });

                        let baseValue = 0;
                        const lastQ = parseInt(quotientInputs[currentDigitIdx]);
                        if (lastQ === 0) baseValue = workingValue;
                        else baseValue = workingValue - (divisor * lastQ);

                        const newWorkingVal = baseValue * 10 + nextDigit;
                        setWorkingValue(newWorkingVal);
                        setCurrentDigitIdx(nextIdx);
                        setPhase('QUOTIENT');
                        setCurrentInput('');
                    } else {
                        setShakeError(true);
                        msg = `è«‹çœ‹ä¸Šæ–¹è¢«é™¤æ•¸ï¼Œé€™ä¸€æ ¼æ‡‰è©²å¡«å…¥ ${nextDigit}`;
                    }
                }

                if (isCorrect) {
                    setFeedback({ type: 'success', text: msg });
                } else {
                    setFeedback({ type: 'error', text: msg });
                }
            };

            const handleWin = () => {
                setScore(s => s + (config.dividendDigits * 10 * config.divisorDigits));
                const newStreak = streak + 1;
                setStreak(newStreak);

                if (isAutoLevel && newStreak >= 2) {
                    const levelIndex = LEVELS.findIndex(l =>
                        l.divisorDigits === config.divisorDigits &&
                        l.dividendDigits === config.dividendDigits
                    );

                    if (levelIndex !== -1) {
                        if (levelIndex < LEVELS.length - 1) {
                            setTimeout(() => {
                                const nextLevel = LEVELS[levelIndex + 1];
                                setConfig(nextLevel);
                                setCurrentLevelIdx(levelIndex + 1);
                                setStreak(0);
                                setFeedback({ type: 'success', text: "é€£å‹ï¼ç­‰ç´šæå‡ï¼" });
                            }, 1500);
                        } else {
                            setTimeout(() => {
                                setShowCertificate(true);
                            }, 1500);
                        }
                    }
                }
            };

            const handleRestart = () => {
                setShowCertificate(false);
                setScore(0);
                setStreak(0);
                setCurrentLevelIdx(0);
                setConfig(LEVELS[0]);
            };

            const handleConfigChange = (type, val) => {
                let newDivisorDigits = config.divisorDigits;
                let newDividendDigits = config.dividendDigits;
                let warningText = "";

                if (type === 'divisor') {
                    newDivisorDigits = val;
                    if (newDivisorDigits >= newDividendDigits) {
                        newDividendDigits = newDivisorDigits + 1;
                        warningText = `é™¤æ•¸ä½æ•¸ (${newDivisorDigits}) éå¤§ï¼Œå·²è‡ªå‹•å°‡è¢«é™¤æ•¸èª¿æ•´ç‚º ${newDividendDigits} ä½ã€‚`;
                    }
                } else if (type === 'dividend') {
                    newDividendDigits = val;
                    if (newDividendDigits <= newDivisorDigits) {
                        newDivisorDigits = Math.max(1, newDividendDigits - 1);
                        warningText = `è¢«é™¤æ•¸ä½æ•¸ (${newDividendDigits}) éå°ï¼Œå·²è‡ªå‹•å°‡é™¤æ•¸èª¿æ•´ç‚º ${newDivisorDigits} ä½ã€‚`;
                    }
                }

                setConfig({ divisorDigits: newDivisorDigits, dividendDigits: newDividendDigits });
                setIsAutoLevel(false);
                setStreak(0);

                if (warningText) {
                    setFeedback({ type: 'error', text: warningText });
                    setShakeError(true);
                    setTimeout(() => setShakeError(false), 500);
                }
            };

            const handleQuotientInput = (val) => {
                if (!val.match(/^\d*$/)) return;
                const digit = val.slice(-1);
                setQuotientInputs(prev => ({ ...prev, [currentDigitIdx]: digit }));
                setShakeError(false);
            };

            const handleWorkInput = (val) => {
                if (!val.match(/^\d*$/)) return;
                if (phase === 'BRING_DOWN') {
                    setCurrentInput(val.slice(-1));
                } else {
                    setCurrentInput(val);
                }
                setShakeError(false);
            };

            const gridCols = dividend.toString().length;
            const gridTemplateColumns = `repeat(${gridCols}, 4rem)`;

            const getCurrentLevelDisplay = () => {
                const idx = LEVELS.findIndex(l =>
                    l.divisorDigits === config.divisorDigits &&
                    l.dividendDigits === config.dividendDigits
                );
                return idx !== -1 ? idx + 1 : '?';
            };

            return (
                <div className="min-h-screen flex flex-col items-center p-4 md:p-8 font-sans text-slate-800">

                    {showCertificate && <Certificate score={score} onRestart={handleRestart} />}

                    {/* Header */}
                    <div className="max-w-4xl w-full flex flex-col md:flex-row gap-4 mb-8 justify-between">
                        <div className="flex flex-col gap-2">
                            <div className="flex items-center gap-4 bg-white p-4 rounded-2xl shadow-sm border border-indigo-100">
                                <div className="p-3 bg-indigo-600 rounded-xl text-white shadow-lg shadow-indigo-200">
                                    <Divide size={24} strokeWidth={3} />
                                </div>
                                <div>
                                    <div className="flex items-center gap-2">
                                        <h1 className="text-xl font-black text-slate-800 tracking-tight">ç›´å¼é™¤æ³•é‹ç®—åš®å°</h1>
                                        {isAutoLevel && (
                                            <span className="bg-amber-100 text-amber-700 text-xs font-bold px-2 py-0.5 rounded-full border border-amber-200">
                                                Level {getCurrentLevelDisplay()}/{LEVELS.length}
                                            </span>
                                        )}
                                    </div>

                                    {/* Config Controls */}
                                    <div className="flex flex-wrap gap-x-4 gap-y-2 mt-2">
                                        <div className="flex items-center gap-1">
                                            <span className="text-[10px] font-bold text-slate-400 uppercase">é™¤æ•¸</span>
                                            {[1, 2, 3].map(d => (
                                                <button key={`div-${d}`} onClick={() => handleConfigChange('divisor', d)} className={`px-2 py-0.5 rounded text-xs font-bold transition-all ${config.divisorDigits === d ? 'bg-indigo-600 text-white shadow' : 'bg-slate-100 text-slate-400 hover:bg-slate-200'}`}>{d}ä½</button>
                                            ))}
                                        </div>
                                        <div className="flex items-center gap-1">
                                            <span className="text-[10px] font-bold text-slate-400 uppercase">è¢«é™¤æ•¸</span>
                                            {[2, 3, 4, 5].map(d => (
                                                <button key={`divd-${d}`} onClick={() => handleConfigChange('dividend', d)} className={`px-2 py-0.5 rounded text-xs font-bold transition-all ${config.dividendDigits === d ? 'bg-amber-500 text-white shadow' : 'bg-slate-100 text-slate-400 hover:bg-slate-200'}`}>{d}ä½</button>
                                            ))}
                                        </div>
                                        <div className="flex items-center gap-1">
                                            <span className="text-[10px] font-bold text-slate-400 uppercase">é¤˜æ•¸è¨­å®š</span>
                                            <button onClick={() => { setIsCleanDivision(false); setIsAutoLevel(false); setStreak(0); }} className={`px-2 py-0.5 rounded text-xs font-bold transition-all ${!isCleanDivision ? 'bg-rose-500 text-white shadow' : 'bg-slate-100 text-slate-400 hover:bg-slate-200'}`}>éš¨æ©Ÿ</button>
                                            <button onClick={() => { setIsCleanDivision(true); setIsAutoLevel(false); setStreak(0); }} className={`px-2 py-0.5 rounded text-xs font-bold transition-all ${isCleanDivision ? 'bg-emerald-500 text-white shadow' : 'bg-slate-100 text-slate-400 hover:bg-slate-200'}`}>æ•´é™¤</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div className="flex gap-4">
                            <div className="bg-white px-6 py-3 rounded-2xl shadow-sm border border-indigo-100 flex flex-col items-center justify-center min-w-[100px]">
                                <span className="text-[10px] font-black text-slate-400 uppercase tracking-wider">Score</span>
                                <span className="text-2xl font-black text-indigo-600 font-mono">{score}</span>
                            </div>
                            <div className="bg-white px-6 py-3 rounded-2xl shadow-sm border border-indigo-100 flex flex-col items-center justify-center min-w-[100px]">
                                <span className="text-[10px] font-black text-slate-400 uppercase tracking-wider">Streak</span>
                                <span className="text-2xl font-black text-amber-500 font-mono">{streak}</span>
                            </div>
                        </div>
                    </div>

                    <div className="max-w-6xl w-full grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
                        <div className="lg:col-span-8 bg-white rounded-[2.5rem] shadow-xl border-4 border-white p-8 md:p-12 flex justify-center min-h-[500px] relative overflow-hidden overflow-x-auto">
                            <div className="absolute inset-0 opacity-10 pointer-events-none" style={{ backgroundImage: 'linear-gradient(#6366f1 1px, transparent 1px), linear-gradient(90deg, #6366f1 1px, transparent 1px)', backgroundSize: '4rem 4.5rem', backgroundPosition: 'center top' }}></div>
                            <div className="division-layout relative z-10">
                                <div className="flex flex-col">
                                    <div className="h-[4.5rem]"></div>
                                    <div className="h-[4.5rem] flex items-center justify-end pr-4 border-r-4 border-slate-800 mr-2">
                                        <span className="text-3xl font-bold text-slate-700 font-mono">{divisor}</span>
                                    </div>
                                </div>
                                <div className="main-column">
                                    <div className="number-grid" style={{ gridTemplateColumns }}>
                                        {dividend.toString().split('').map((_, i) => (
                                            <div key={`q-${i}`} className="cell">
                                                {(i === currentDigitIdx && phase === 'QUOTIENT') ? (
                                                    <div className={`w-full h-full flex items-center justify-center p-1 ${shakeError ? 'animate-shake' : ''}`}>
                                                        <input ref={inputRef} type="text" value={quotientInputs[i] || ''} onChange={(e) => handleQuotientInput(e.target.value)} onKeyDown={(e) => e.key === 'Enter' && handleCheck()} className="grid-input quotient-input text-indigo-700" placeholder="?" />
                                                        <InstructionBubble text={getCurrentHint()} type="info" show={true} />
                                                    </div>
                                                ) : (
                                                    <span className={`transition-all ${i === currentDigitIdx ? 'text-indigo-600 scale-125' : 'text-slate-800'}`}>{quotientInputs[i] || ''}</span>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                    <div className="h-1 bg-slate-800 w-full mb-1 -ml-2 rounded-full" style={{ width: 'calc(100% + 1rem)' }}></div>
                                    <div className="number-grid" style={{ gridTemplateColumns }}>
                                        {dividend.toString().split('').map((d, i) => (
                                            <div key={`d-${i}`} className="cell">
                                                {d}
                                                {phase === 'BRING_DOWN' && i === currentDigitIdx + 1 && (
                                                    <div className="absolute top-12 text-amber-500 animate-bounce z-10"><ArrowDown size={32} strokeWidth={3} /></div>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                    <div className="number-grid" style={{ gridTemplateColumns }}>
                                        {historyRows.map((row, rIdx) => {
                                            const valStr = row.value.toString();
                                            const len = valStr.length;
                                            const colEnd = row.alignIndex + 2;
                                            const colStart = colEnd - len;
                                            return (
                                                <React.Fragment key={rIdx}>
                                                    {row.type === 'product' && (
                                                        <div className="col-span-full relative h-[4.5rem]">
                                                            <div className="absolute border-b-2 border-slate-300 w-full flex items-center justify-end pr-2" style={{ gridColumn: `${colStart} / ${colEnd}`, left: `${(colStart - 1) * 4}rem`, width: `${len * 4}rem`, height: '100%' }}>
                                                                <span className="absolute -left-6 text-slate-400 text-2xl top-4">-</span>
                                                                <div className="flex justify-between w-full">
                                                                    {valStr.split('').map((c, ci) => <span key={ci} className="w-[4rem] text-center text-slate-500 text-3xl font-bold">{c}</span>)}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    )}
                                                    {row.type === 'remainder' && (
                                                        <div className="col-span-full relative h-[4.5rem]">
                                                            <div className="absolute flex items-center" style={{ left: `${(colStart - 1) * 4}rem`, height: '100%' }}>
                                                                <div className="flex">
                                                                    {valStr.split('').map((c, ci) => {
                                                                        const isCrossedZero = valStr === '0' && row.broughtDown && row.broughtDown.length > 0;
                                                                        return <div key={ci} className={`w-[4rem] flex justify-center items-center text-slate-700 text-3xl font-bold ${isCrossedZero ? 'crossed-zero' : ''}`}>{c}</div>;
                                                                    })}
                                                                </div>
                                                                {row.broughtDown && row.broughtDown.map((bdDigit, bdIdx) => (
                                                                    <div key={`bd-${rIdx}-${bdIdx}`} className="w-[4rem] flex justify-center items-center text-amber-600 text-3xl font-bold animate-slide-down">{bdDigit}</div>
                                                                ))}
                                                                {phase === 'BRING_DOWN' && rIdx === historyRows.length - 1 && (
                                                                    <div className="w-[4rem] flex justify-center items-center relative">
                                                                        <div className={`w-full h-full p-2 ${shakeError ? 'animate-shake' : ''}`}>
                                                                            <input ref={inputRef} type="text" value={currentInput} onChange={(e) => handleWorkInput(e.target.value)} onKeyDown={(e) => e.key === 'Enter' && handleCheck()} className="grid-input bg-amber-50 border-2 border-amber-400 text-amber-700 focus:ring-4 focus:ring-amber-100" placeholder="" />
                                                                            <InstructionBubble text={getCurrentHint()} type="hint" show={true} />
                                                                        </div>
                                                                    </div>
                                                                )}
                                                            </div>
                                                        </div>
                                                    )}
                                                </React.Fragment>
                                            );
                                        })}

                                        {/* ACTIVE DIGIT INPUT FOR MULTIPLY/SUBTRACT */}
                                        {(phase === 'MULTIPLY' || phase === 'SUBTRACT') && (
                                            <div className="col-span-full relative h-[4.5rem]">
                                                {(() => {
                                                    let targetValue = 0;
                                                    if (phase === 'MULTIPLY') {
                                                        targetValue = divisor * parseInt(quotientInputs[currentDigitIdx]);
                                                    } else {
                                                        const q = parseInt(quotientInputs[currentDigitIdx]);
                                                        targetValue = workingValue - (divisor * q);
                                                    }

                                                    const targetStr = targetValue.toString();
                                                    const len = targetStr.length;
                                                    const alignIndex = currentDigitIdx;

                                                    return (
                                                        <div className="absolute w-full h-full">
                                                            {phase === 'MULTIPLY' && (
                                                                <span className="absolute text-indigo-400 font-bold text-2xl top-4" style={{ left: `${(alignIndex - len) * 4}rem`, transform: 'translateX(-1.5rem)' }}>-</span>
                                                            )}
                                                            {targetStr.split('').map((char, charIdx) => {
                                                                const gridCol = alignIndex - (len - 1 - charIdx);
                                                                const isEntered = charIdx >= len - stepProgress;
                                                                const isActive = charIdx === len - 1 - stepProgress;

                                                                return (
                                                                    <div key={charIdx} className="absolute w-[4rem] h-[4.5rem] flex items-center justify-center top-0" style={{ left: `${gridCol * 4}rem` }}>
                                                                        {isEntered ? (
                                                                            <span className="text-3xl font-bold text-slate-700">{char}</span>
                                                                        ) : isActive ? (
                                                                            <div className={`w-full h-full p-1 ${shakeError ? 'animate-shake' : ''}`}>
                                                                                <input ref={digitInputRef} type="text" value="" onChange={(e) => handleDigitInput(e.target.value, char)} className={`grid-input text-indigo-700 border-b-2 border-dashed ${phase === 'MULTIPLY' ? 'border-indigo-400' : 'border-amber-400 bg-white'}`} placeholder="?" />
                                                                                <InstructionBubble text="ç”±å€‹ä½å¡«å…¥" type="info" show={stepProgress === 0} />
                                                                            </div>
                                                                        ) : (
                                                                            <span className="text-slate-300"></span>
                                                                        )}
                                                                    </div>
                                                                );
                                                            })}
                                                        </div>
                                                    );
                                                })()}
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Side Panel */}
                        <div className="lg:col-span-4 space-y-6">
                            <div className="bg-white rounded-[2rem] shadow-lg p-6 border border-slate-100 relative overflow-hidden">
                                <div className={`absolute top-0 left-0 w-2 h-full ${phase === 'QUOTIENT' ? 'bg-indigo-500' : phase === 'MULTIPLY' ? 'bg-blue-500' : phase === 'SUBTRACT' ? 'bg-amber-500' : phase === 'FINISHED' ? 'bg-green-500' : 'bg-yellow-500'}`}></div>
                                <h2 className="text-lg font-black text-slate-800 mb-4 flex items-center gap-2">
                                    <Sparkles className="text-yellow-400 fill-yellow-400" size={18} /> ç•¶å‰ä»»å‹™
                                </h2>
                                <div className="min-h-[100px] mb-6 relative">
                                    {phase === 'FINISHED' ? (
                                        <div className="text-center py-2"><div className="inline-block p-3 bg-green-100 rounded-full text-green-600 mb-2"><Trophy size={32} className="fill-current" /></div><h3 className="text-xl font-black text-slate-800">å®Œç¾è§£æ±ºï¼</h3></div>
                                    ) : (
                                        <>
                                            {!showHint && <p className="text-lg text-slate-600 font-medium leading-relaxed animate-fade-in">{feedback?.text || getCurrentHint()}</p>}
                                            {showHint && <div className="bg-indigo-50 rounded-xl p-4 text-sm text-slate-700 leading-relaxed border border-indigo-100 animate-pop-in">{getSmartHint()}</div>}
                                        </>
                                    )}
                                </div>
                                <div className="flex flex-col gap-3">
                                    {(phase === 'QUOTIENT' || phase === 'BRING_DOWN') && (
                                        <button onClick={handleCheck} className="flex-1 py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 hover:shadow-xl hover:-translate-y-1 transition-all flex justify-center items-center gap-2">æª¢æŸ¥ç­”æ¡ˆ <ChevronRight size={18} /></button>
                                    )}
                                    {(phase === 'MULTIPLY' || phase === 'SUBTRACT') && (
                                        <div className="flex-1 py-3 bg-slate-100 text-slate-400 rounded-xl font-bold flex justify-center items-center gap-2 cursor-default">è«‹ä¾åºè¼¸å…¥æ•¸å­—...</div>
                                    )}

                                    {phase !== 'FINISHED' && (
                                        <button onClick={() => setShowHint(!showHint)} className={`px-4 py-3 rounded-xl font-bold shadow-lg transition-all flex justify-center items-center gap-2 ${showHint ? 'bg-amber-100 text-amber-700 shadow-amber-100 border-2 border-amber-300' : 'bg-amber-400 text-white shadow-amber-200 hover:bg-amber-500'}`}><Lightbulb size={20} className={showHint ? "fill-amber-500 text-amber-500" : "fill-white"} />{showHint ? 'é—œé–‰æç¤º' : 'æ±‚æ•‘'}</button>
                                    )}
                                    {phase === 'FINISHED' && <button ref={nextButtonRef} onClick={generateProblem} className="w-full py-4 bg-slate-900 text-white rounded-xl font-bold shadow-lg shadow-slate-200 hover:shadow-xl hover:-translate-y-1 transition-all flex justify-center items-center gap-2 focus:ring-4 focus:ring-slate-300 outline-none">ä¸‹ä¸€é¡Œ <RefreshCcw size={18} /></button>}
                                </div>
                            </div>
                            <div className="bg-white p-6 rounded-3xl border border-slate-200 flex flex-col gap-4">
                                <div className="flex items-center justify-between"><div className="flex items-center gap-2 text-xs font-black text-slate-500"><Settings size={14} /> è‡ªå‹•æ™‰ç´šæŒ‘æˆ°</div><button onClick={() => { setIsAutoLevel(!isAutoLevel); setStreak(0); }} className={`w-12 h-7 rounded-full relative transition-colors duration-300 ${isAutoLevel ? 'bg-indigo-600' : 'bg-slate-200'}`}><div className={`absolute top-1 w-5 h-5 bg-white rounded-full transition-all duration-300 shadow-sm ${isAutoLevel ? 'left-6' : 'left-1'}`} /></button></div>
                                {isAutoLevel && <div className="text-xs text-indigo-600 bg-indigo-50 p-3 rounded-xl text-center font-bold flex items-center justify-center gap-2 border border-indigo-100 animate-fade-in"><span className="text-lg">ğŸ”¥</span> <span>é€£å‹ 2 å ´å°‡è‡ªå‹•å¢åŠ é›£åº¦ï¼</span></div>}
                            </div>
                        </div>
                    </div>
                    <InfoCards />
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>