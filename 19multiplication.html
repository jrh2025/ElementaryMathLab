<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>19x19 ‰πòÊ≥ïÂ§ßÂ∏´</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=JetBrains+Mono:wght@400;700&display=swap');

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f8fafc;
        }

        /* Custom Scrollbar for Reference Table */
        .custom-scrollbar::-webkit-scrollbar {
            height: 8px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Animations */
        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-5px);
            }

            75% {
                transform: translateX(5px);
            }
        }

        .animate-shake {
            animation: shake 0.4s ease-in-out;
        }

        @keyframes bounce-short {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-5px);
            }
        }

        .animate-bounce-short {
            animation: bounce-short 0.5s ease-in-out;
        }

        @keyframes fade-in-up {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in-up {
            animation: fade-in-up 0.5s ease-out forwards;
        }

        @keyframes fade-in {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .animate-fade-in {
            animation: fade-in 0.5s ease-out forwards;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Icon Components (Lucide) ---
        // Replacing external dependency with inline SVGs for reliability in single HTML file
        const IconBase = ({ children, size = 20, className = "", ...props }) => (
            <svg
                xmlns="http://www.w3.org/2000/svg"
                width={size}
                height={size}
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                strokeWidth="2"
                strokeLinecap="round"
                strokeLinejoin="round"
                className={className}
                {...props}
            >
                {children}
            </svg>
        );

        const BookOpen = (props) => <IconBase {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" /><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" /></IconBase>;
        const Calculator = (props) => <IconBase {...props}><rect width="16" height="20" x="4" y="2" rx="2" /><line x1="8" x2="16" y1="6" y2="6" /><line x1="16" x2="16" y1="14" y2="18" /><path d="M16 10h.01" /><path d="M12 10h.01" /><path d="M8 10h.01" /><path d="M12 14h.01" /><path d="M8 14h.01" /><path d="M12 18h.01" /><path d="M8 18h.01" /></IconBase>;
        const Award = (props) => <IconBase {...props}><circle cx="12" cy="8" r="6" /><path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11" /></IconBase>;
        const Lightbulb = (props) => <IconBase {...props}><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5" /><path d="M9 18h6" /><path d="M10 22h4" /></IconBase>;
        const RefreshCw = (props) => <IconBase {...props}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" /><path d="M21 3v5h-5" /><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" /><path d="M8 16H3v5" /></IconBase>;
        const ChevronRight = (props) => <IconBase {...props}><path d="m9 18 6-6-6-6" /></IconBase>;
        const X = (props) => <IconBase {...props}><path d="M18 6 6 18" /><path d="m6 6 12 12" /></IconBase>;
        const Check = (props) => <IconBase {...props}><path d="M20 6 9 17l-5-5" /></IconBase>;
        const GraduationCap = (props) => <IconBase {...props}><path d="M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z" /><path d="M22 10v6" /><path d="M6 12.5V16a6 3 0 0 0 12 0v-3.5" /></IconBase>;
        const ArrowRight = (props) => <IconBase {...props}><path d="M5 12h14" /><path d="m12 5 7 7-7 7" /></IconBase>;
        const Play = (props) => <IconBase {...props}><polygon points="5 3 19 12 5 21 5 3" /></IconBase>;
        const MousePointerClick = (props) => <IconBase {...props}><path d="M14 4.1 12 6" /><path d="m5.1 8-2.9-.8" /><path d="m6 12-1.9 2" /><path d="M7.2 2.2 8 5.1" /><path d="M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z" /></IconBase>;

        // ----------------------------------------------------------------------
        // Main App
        // ----------------------------------------------------------------------
        const App = () => {
            const [activeTab, setActiveTab] = useState('tutorial'); // Default to tutorial

            return (
                <div className="min-h-screen bg-slate-50 text-slate-800 font-sans selection:bg-indigo-100 pb-8">
                    {/* Header */}
                    <header className="bg-white shadow-sm border-b border-slate-200 sticky top-0 z-50">
                        <div className="max-w-5xl mx-auto px-4 h-16 flex items-center justify-between">
                            <div className="flex items-center gap-2 cursor-pointer" onClick={() => setActiveTab('learn')}>
                                <div className="bg-indigo-600 p-2 rounded-lg text-white">
                                    <Calculator size={20} />
                                </div>
                                <h1 className="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-600 to-violet-600 hidden sm:block">
                                    19x19 ‰πòÊ≥ïÂ§ßÂ∏´
                                </h1>
                            </div>
                            <nav className="flex gap-1 md:gap-2">
                                <button
                                    onClick={() => setActiveTab('learn')}
                                    className={`px-3 py-2 rounded-full text-sm font-medium transition-all flex items-center gap-1 ${activeTab === 'learn'
                                            ? 'bg-indigo-100 text-indigo-700 ring-2 ring-indigo-200'
                                            : 'text-slate-500 hover:bg-slate-100'
                                        }`}
                                >
                                    <BookOpen size={16} /> <span className="hidden md:inline">Â≠∏ÁøíË°®</span>
                                </button>
                                <button
                                    onClick={() => setActiveTab('tutorial')}
                                    className={`px-3 py-2 rounded-full text-sm font-medium transition-all flex items-center gap-1 ${activeTab === 'tutorial'
                                            ? 'bg-emerald-100 text-emerald-700 ring-2 ring-emerald-200'
                                            : 'text-slate-500 hover:bg-slate-100'
                                        }`}
                                >
                                    <GraduationCap size={16} /> <span>ÈÄêÊ≠•ÊïôÂ≠∏</span>
                                </button>
                                <button
                                    onClick={() => setActiveTab('practice')}
                                    className={`px-3 py-2 rounded-full text-sm font-medium transition-all flex items-center gap-1 ${activeTab === 'practice'
                                            ? 'bg-amber-100 text-amber-700 ring-2 ring-amber-200'
                                            : 'text-slate-500 hover:bg-slate-100'
                                        }`}
                                >
                                    <Award size={16} /> <span className="hidden md:inline">ÊåëÊà∞ÂçÄ</span>
                                </button>
                            </nav>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="max-w-5xl mx-auto px-4 py-8">
                        {activeTab === 'learn' && <ReferenceTable />}
                        {activeTab === 'practice' && <PracticeMode />}
                        {activeTab === 'tutorial' && <TutorialMode />}
                    </main>

                    {/* Footer */}
                    <footer className="text-center py-6 text-slate-400 text-sm">
                        <p>¬© 2025 Êô∫ÊÖßÊï∏Â≠∏ÂØ¶È©óÂÆ§ | Â∞àÁÇ∫ÈÄ≤ÈöéÈÅãÁÆóÊÄùÁ∂≠Ë®≠Ë®à</p>
                    </footer>
                </div>
            );
        };

        // ----------------------------------------------------------------------
        // Component: Reference Table (Updated: Click interaction)
        // ----------------------------------------------------------------------
        const ReferenceTable = () => {
            const [hoverCell, setHoverCell] = useState(null);
            const [selectedCell, setSelectedCell] = useState(null);
            // Generate range 11-19
            const range = Array.from({ length: 9 }, (_, i) => i + 11);

            // Helper to calculate Indian Math steps for display
            const getSteps = (r, c) => {
                const step1 = r + (c % 10);
                const step2 = step1 * 10;
                const step3 = (r % 10) * (c % 10);
                return { step1, step2, step3 };
            };

            return (
                <div className="space-y-6 animate-fade-in">
                    <div className="grid md:grid-cols-3 gap-6">
                        {/* Table Section */}
                        <div className="md:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
                            <div className="mb-4">
                                <h2 className="text-2xl font-bold text-slate-800">19x19 ÈÄ≤Èöé‰πòÊ≥ïË°®</h2>
                                <p className="text-slate-500 flex items-center gap-2">
                                    <MousePointerClick size={16} /> ÈªûÊìäÊ†ºÂ≠êÂèØÊü•ÁúãË©≥Á¥∞ÁÆóÂºè
                                </p>
                            </div>

                            <div className="overflow-x-auto pb-4 custom-scrollbar">
                                <div className="inline-block min-w-full">
                                    <div
                                        className="grid gap-1"
                                        style={{ gridTemplateColumns: 'repeat(10, minmax(45px, 1fr))' }}
                                    >
                                        {/* Header Row */}
                                        <div className="bg-slate-100 p-2 rounded text-center font-bold text-slate-400">√ó</div>
                                        {range.map(num => (
                                            <div key={`h-${num}`} className="bg-indigo-50 p-2 rounded text-center font-bold text-indigo-600 text-sm md:text-base">
                                                {num}
                                            </div>
                                        ))}

                                        {/* Rows */}
                                        {range.map(rowNum => (
                                            <React.Fragment key={`row-${rowNum}`}>
                                                <div className="bg-indigo-50 p-2 rounded text-center font-bold text-indigo-600 flex items-center justify-center text-sm md:text-base">
                                                    {rowNum}
                                                </div>
                                                {range.map(colNum => {
                                                    const isHovered = hoverCell && (hoverCell.r === rowNum || hoverCell.c === colNum);
                                                    const isTarget = hoverCell && hoverCell.r === rowNum && hoverCell.c === colNum;
                                                    const isSelected = selectedCell && selectedCell.r === rowNum && selectedCell.c === colNum;

                                                    return (
                                                        <div
                                                            key={`${rowNum}-${colNum}`}
                                                            onMouseEnter={() => setHoverCell({ r: rowNum, c: colNum })}
                                                            onMouseLeave={() => setHoverCell(null)}
                                                            onClick={() => setSelectedCell({ r: rowNum, c: colNum })}
                                                            className={`
                                    aspect-square flex items-center justify-center rounded cursor-pointer transition-all duration-200 text-sm font-medium
                                    ${isSelected
                                                                    ? 'bg-amber-500 text-white font-bold scale-110 shadow-lg ring-2 ring-amber-300 z-20'
                                                                    : isTarget
                                                                        ? 'bg-indigo-600 text-white font-bold scale-110 shadow-lg z-10'
                                                                        : isHovered
                                                                            ? 'bg-indigo-100 text-indigo-900'
                                                                            : 'bg-white text-slate-600 hover:bg-amber-50 border border-slate-100'}
                                  `}
                                                        >
                                                            {rowNum * colNum}
                                                        </div>
                                                    );
                                                })}
                                            </React.Fragment>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Explanation Section (Right Panel) */}
                        <div className="md:col-span-1">
                            {selectedCell ? (
                                <div className="bg-amber-50 p-6 rounded-2xl border border-amber-200 shadow-lg h-full animate-fade-in sticky top-24">
                                    <div className="flex justify-between items-start mb-6">
                                        <div>
                                            <h3 className="text-amber-800 font-bold uppercase text-xs tracking-wider mb-1">Ë©≥Á¥∞ÁÆóÂºèÊãÜËß£</h3>
                                            <div className="text-3xl font-black text-slate-800 font-mono">
                                                {selectedCell.r} √ó {selectedCell.c} = <span className="text-amber-600">{selectedCell.r * selectedCell.c}</span>
                                            </div>
                                        </div>
                                        <button onClick={() => setSelectedCell(null)} className="text-amber-400 hover:text-amber-600">
                                            <X size={20} />
                                        </button>
                                    </div>

                                    {(() => {
                                        const { step1, step2, step3 } = getSteps(selectedCell.r, selectedCell.c);
                                        return (
                                            <div className="space-y-4">
                                                <div className="bg-white p-3 rounded-xl border border-amber-100 shadow-sm">
                                                    <div className="text-xs text-amber-600 font-bold mb-1">Step 1: È†≠Âä†Â∞æ</div>
                                                    <div className="font-mono text-lg">
                                                        {selectedCell.r} + <span className="text-blue-600">{selectedCell.c % 10}</span> = <strong>{step1}</strong>
                                                    </div>
                                                </div>

                                                <div className="bg-white p-3 rounded-xl border border-amber-100 shadow-sm">
                                                    <div className="text-xs text-amber-600 font-bold mb-1">Step 2: Ë£úÂÄãÈõ∂</div>
                                                    <div className="font-mono text-lg">
                                                        {step1} √ó 10 = <strong>{step2}</strong>
                                                    </div>
                                                </div>

                                                <div className="bg-white p-3 rounded-xl border border-amber-100 shadow-sm">
                                                    <div className="text-xs text-amber-600 font-bold mb-1">Step 3: Â∞æ‰πòÂ∞æ</div>
                                                    <div className="font-mono text-lg">
                                                        <span className="text-blue-600">{selectedCell.r % 10}</span> √ó <span className="text-blue-600">{selectedCell.c % 10}</span> = <strong>{step3}</strong>
                                                    </div>
                                                </div>

                                                <div className="pt-2 border-t border-amber-200">
                                                    <div className="text-xs text-slate-500 font-bold mb-1 uppercase">Á∏ΩÂíå</div>
                                                    <div className="font-mono text-xl font-bold text-indigo-700">
                                                        {step2} + {step3} = {step2 + step3}
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })()}
                                </div>
                            ) : (
                                <div className="bg-slate-100 p-8 rounded-2xl border-2 border-dashed border-slate-200 h-full flex flex-col items-center justify-center text-center text-slate-400 min-h-[300px]">
                                    <MousePointerClick size={48} className="mb-4 opacity-50" />
                                    <p>ÈªûÊìäÂ∑¶ÂÅ¥Ë°®Ê†º‰∏≠ÁöÑ‰ªª‰∏ÄÊï∏Â≠ó</p>
                                    <p className="text-sm mt-2">Âç≥ÂèØÊü•ÁúãË©≤Êï∏Â≠óÁöÑ<br />Âç∞Â∫¶Êï∏Â≠∏ÈÄüÁÆóÈÅéÁ®ã</p>
                                </div>
                            )}
                        </div>
                    </div>

                    {!selectedCell && (
                        <div className="bg-indigo-900 text-white p-6 rounded-2xl shadow-lg">
                            <h3 className="font-bold text-lg mb-2 flex items-center gap-2">
                                <Lightbulb className="text-yellow-400" />
                                ÈÄüÁÆóÊ†∏ÂøÉÊ¶ÇÂøµ
                            </h3>
                            <p className="opacity-90 leading-relaxed">
                                Â∞çÊñº <span className="font-mono bg-indigo-800 px-1 rounded">12 √ó 13</span> ÈÄôÊ®£ÁöÑÁÆóÂºèÔºö<br />
                                (1) <strong>È†≠Âä†Â∞æ</strong>Ôºö12 + 3 = 15 <br />
                                (2) <strong>Ë£úÂÄãÈõ∂</strong>Ôºö150 <br />
                                (3) <strong>Â∞æ‰πòÂ∞æ</strong>Ôºö2 √ó 3 = 6 <br />
                                (4) <strong>Áõ∏Âä†</strong>Ôºö150 + 6 = 156
                            </p>
                        </div>
                    )}
                </div>
            );
        };

        // ----------------------------------------------------------------------
        // Component: Tutorial Mode (Updated: Collapsible Steps)
        // ----------------------------------------------------------------------
        const TutorialMode = () => {
            const [question, setQuestion] = useState({ a: 12, b: 13 });
            const [step, setStep] = useState(1);
            const [input, setInput] = useState('');
            const [feedback, setFeedback] = useState('idle');
            const [history, setHistory] = useState({ step1: null, step2: null, step3: null });
            const inputRef = useRef(null);

            useEffect(() => {
                generateQuestion();
            }, []);

            useEffect(() => {
                if (inputRef.current) {
                    setTimeout(() => inputRef.current?.focus(), 10);
                }
            }, [step, feedback]);

            const generateQuestion = () => {
                const a = Math.floor(Math.random() * 9) + 11;
                const b = Math.floor(Math.random() * 9) + 11;
                setQuestion({ a, b });
                setStep(1);
                setInput('');
                setFeedback('idle');
                setHistory({ step1: null, step2: null, step3: null });
            };

            const checkAnswer = (e) => {
                e.preventDefault();
                const val = parseInt(input);
                let isCorrect = false;

                const unitB = question.b % 10;
                const unitA = question.a % 10;

                if (step === 1) {
                    const target = question.a + unitB;
                    if (val === target) {
                        isCorrect = true;
                        setHistory(h => ({ ...h, step1: val }));
                    }
                } else if (step === 2) {
                    const target = history.step1 * 10;
                    if (val === target) {
                        isCorrect = true;
                        setHistory(h => ({ ...h, step2: val }));
                    }
                } else if (step === 3) {
                    const target = unitA * unitB;
                    if (val === target) {
                        isCorrect = true;
                        setHistory(h => ({ ...h, step3: val }));
                    }
                } else if (step === 4) {
                    const target = history.step2 + history.step3;
                    if (val === target) {
                        isCorrect = true;
                    }
                }

                if (isCorrect) {
                    setFeedback('idle');
                    setInput('');
                    if (step < 4) {
                        setStep(s => s + 1);
                    } else {
                        setStep(5); // Success
                    }
                } else {
                    setFeedback('error');
                    if (inputRef.current) inputRef.current.focus();
                }
            };

            if (step === 5) {
                return (
                    <div className="max-w-xl mx-auto text-center py-12 animate-fade-in-up">
                        <div className="bg-white rounded-3xl p-8 shadow-xl border-2 border-green-100">
                            <div className="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6 text-green-600">
                                <Check size={40} strokeWidth={4} />
                            </div>
                            <h2 className="text-3xl font-black text-slate-800 mb-2">ÊÅ≠ÂñúÂÆåÊàêÔºÅ</h2>
                            <p className="text-slate-500 mb-8 text-lg">
                                <span className="font-mono font-bold text-slate-700 mt-2 block text-2xl">{question.a} √ó {question.b} = {question.a * question.b}</span>
                            </p>
                            <button
                                onClick={generateQuestion}
                                className="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-xl transition-transform active:scale-95 shadow-lg shadow-indigo-200 flex items-center gap-2 mx-auto"
                            >
                                <RefreshCw size={20} /> Á∑¥Áøí‰∏ã‰∏ÄÈ°å
                            </button>
                        </div>
                    </div>
                );
            }

            const renderInput = () => (
                <form onSubmit={checkAnswer} className="inline-block ml-2 relative">
                    <input
                        ref={inputRef}
                        type="number"
                        value={input}
                        onChange={(e) => { setInput(e.target.value); setFeedback('idle'); }}
                        className={`w-24 border-b-2 text-center outline-none bg-transparent transition-colors font-bold text-xl py-1
                  ${feedback === 'error' ? 'border-red-400 text-red-600 bg-red-50/50' : 'border-indigo-600 text-indigo-600 focus:bg-indigo-50/30'}
                  placeholder:text-slate-200
                `}
                        placeholder="?"
                        autoFocus
                        autoComplete="off"
                    />
                    {feedback === 'error' && <span className="absolute -right-6 top-1 text-red-500 text-lg animate-shake font-bold">!</span>}
                </form>
            );

            // Compact Step Component for completed steps
            const CompletedStep = ({ id, title, formula, result }) => (
                <div className="flex items-center gap-4 p-3 bg-green-50 rounded-xl border border-green-100 text-slate-600 animate-fade-in mb-2">
                    <div className="w-8 h-8 rounded-full bg-green-500 text-white flex items-center justify-center font-bold text-sm shadow-sm flex-shrink-0">
                        <Check size={16} strokeWidth={3} />
                    </div>
                    <div className="flex-1 flex justify-between items-center overflow-hidden">
                        <span className="font-bold text-xs uppercase text-green-700 tracking-wider flex-shrink-0 mr-2">{title}</span>
                        <div className="font-mono text-sm truncate">
                            {formula} = <span className="font-bold text-slate-800 text-base">{result}</span>
                        </div>
                    </div>
                </div>
            );

            return (
                <div className="max-w-2xl mx-auto animate-fade-in">
                    {/* Question Header */}
                    <div className="bg-white rounded-t-3xl border-b border-slate-100 p-6 flex justify-center items-center gap-4 shadow-sm relative z-10">
                        <span className="text-3xl font-bold text-slate-800">{question.a}</span>
                        <span className="text-xl text-slate-300">√ó</span>
                        <span className="text-3xl font-bold text-slate-800">{question.b}</span>
                    </div>

                    <div className="bg-white rounded-b-3xl shadow-xl border border-slate-200 p-4 md:p-6 min-h-[400px]">

                        {/* Step 1 */}
                        {step > 1 ? (
                            <CompletedStep
                                id={1}
                                title="Step 1: È†≠Âä†Â∞æ"
                                formula={`${question.a} + ${question.b % 10}`}
                                result={history.step1}
                            />
                        ) : (
                            <div className="p-4 rounded-2xl border bg-indigo-50 border-indigo-200 shadow-sm animate-fade-in">
                                <div className="text-sm font-bold text-slate-500 mb-3 uppercase tracking-wide flex items-center gap-2">
                                    <span className="w-6 h-6 rounded-full bg-indigo-600 text-white flex items-center justify-center text-xs">1</span>
                                    Step 1: È†≠Âä†Â∞æ
                                </div>
                                <div className="font-mono text-2xl flex flex-wrap items-center gap-2 text-slate-700 justify-center py-4">
                                    <span>{question.a}</span>
                                    <span className="text-slate-400">+</span>
                                    <span className="text-blue-600 font-bold">{question.b % 10}</span>
                                    <span className="text-slate-400">=</span>
                                    {renderInput()}
                                </div>
                                <div className="text-xs text-center text-slate-500">Ë¢´‰πòÊï∏ ({question.a}) Âä†‰∏ä ‰πòÊï∏ÁöÑÂÄã‰ΩçÊï∏ ({question.b % 10})</div>
                            </div>
                        )}

                        {/* Step 2 */}
                        {step > 2 ? (
                            <CompletedStep
                                id={2}
                                title="Step 2: Ë£úÂÄãÈõ∂"
                                formula={`${history.step1} √ó 10`}
                                result={history.step2}
                            />
                        ) : step === 2 && (
                            <div className="p-4 rounded-2xl border bg-indigo-50 border-indigo-200 shadow-sm animate-fade-in mt-2">
                                <div className="text-sm font-bold text-slate-500 mb-3 uppercase tracking-wide flex items-center gap-2">
                                    <span className="w-6 h-6 rounded-full bg-indigo-600 text-white flex items-center justify-center text-xs">2</span>
                                    Step 2: Ë£úÂÄãÈõ∂
                                </div>
                                <div className="font-mono text-2xl flex flex-wrap items-center gap-2 text-slate-700 justify-center py-4">
                                    <span>{history.step1}</span>
                                    <span className="text-slate-400">√ó</span>
                                    <span className="text-slate-600">10</span>
                                    <span className="text-slate-400">=</span>
                                    {renderInput()}
                                </div>
                                <div className="text-xs text-center text-slate-500">Â∞á‰∏ä‰∏ÄÊ≠•ÁöÑÁµêÊûú‰πò‰ª• 10 (ÂæåÈù¢Âä†ÂÄã0)</div>
                            </div>
                        )}

                        {/* Step 3 */}
                        {step > 3 ? (
                            <CompletedStep
                                id={3}
                                title="Step 3: Â∞æ‰πòÂ∞æ"
                                formula={`${question.a % 10} √ó ${question.b % 10}`}
                                result={history.step3}
                            />
                        ) : step === 3 && (
                            <div className="p-4 rounded-2xl border bg-indigo-50 border-indigo-200 shadow-sm animate-fade-in mt-2">
                                <div className="text-sm font-bold text-slate-500 mb-3 uppercase tracking-wide flex items-center gap-2">
                                    <span className="w-6 h-6 rounded-full bg-indigo-600 text-white flex items-center justify-center text-xs">3</span>
                                    Step 3: Â∞æ‰πòÂ∞æ
                                </div>
                                <div className="font-mono text-2xl flex flex-wrap items-center gap-2 text-slate-700 justify-center py-4">
                                    <span className="text-blue-600 font-bold">{question.a % 10}</span>
                                    <span className="text-slate-400">√ó</span>
                                    <span className="text-blue-600 font-bold">{question.b % 10}</span>
                                    <span className="text-slate-400">=</span>
                                    {renderInput()}
                                </div>
                                <div className="text-xs text-center text-slate-500">ÂÄã‰ΩçÊï∏ ({question.a % 10}) ‰πò‰ª• ÂÄã‰ΩçÊï∏ ({question.b % 10})</div>
                            </div>
                        )}

                        {/* Step 4 */}
                        {step === 4 && (
                            <div className="p-4 rounded-2xl border bg-indigo-50 border-indigo-200 shadow-sm animate-fade-in mt-2">
                                <div className="text-sm font-bold text-slate-500 mb-3 uppercase tracking-wide flex items-center gap-2">
                                    <span className="w-6 h-6 rounded-full bg-indigo-600 text-white flex items-center justify-center text-xs">4</span>
                                    Step 4: Á∏ΩÂíå
                                </div>
                                <div className="font-mono text-2xl flex flex-wrap items-center gap-2 text-slate-700 justify-center py-4">
                                    <span className="font-bold text-indigo-700">{history.step2}</span>
                                    <span className="text-slate-400">+</span>
                                    <span className="font-bold text-indigo-700">{history.step3}</span>
                                    <span className="text-slate-400">=</span>
                                    {renderInput()}
                                </div>
                                <div className="text-xs text-center text-slate-500">ÊúÄÂæåÔºåÂ∞á Step 2 Âíå Step 3 ÁöÑÁµêÊûúÁõ∏Âä†</div>
                            </div>
                        )}

                        {/* Action Button */}
                        <button
                            onClick={checkAnswer}
                            className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-xl shadow-lg shadow-indigo-200 flex items-center justify-center gap-2 active:scale-95 transition-transform mt-6"
                        >
                            {step === 4 ? 'ÂÆåÊàêË®àÁÆó' : '‰∏ã‰∏ÄÊ≠•'} <ArrowRight size={18} />
                        </button>

                    </div>
                </div>
            );
        };

        // ----------------------------------------------------------------------
        // Component: Practice Mode
        // ----------------------------------------------------------------------
        const PracticeMode = () => {
            const [question, setQuestion] = useState({ a: 0, b: 0 });
            const [input, setInput] = useState('');
            const [gameState, setGameState] = useState('idle');
            const [score, setScore] = useState(0);
            const [streak, setStreak] = useState(0);
            const [showHint, setShowHint] = useState(false);
            const inputRef = useRef(null);

            const generateQuestion = () => {
                // Strictly 11-19
                const a = Math.floor(Math.random() * 9) + 11;
                const b = Math.floor(Math.random() * 9) + 11;

                setQuestion({ a, b });
                setInput('');
                setGameState('idle');
                setShowHint(false);
                setTimeout(() => inputRef.current?.focus(), 50);
            };

            useEffect(() => {
                generateQuestion();
            }, []);

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!input) return;
                const answer = parseInt(input);
                const correctAnswer = question.a * question.b;

                if (answer === correctAnswer) {
                    setGameState('correct');
                    setScore(s => s + 10 + (streak * 2));
                    setStreak(s => s + 1);
                    setTimeout(generateQuestion, 1200);
                } else {
                    setGameState('wrong');
                    setStreak(0);
                    inputRef.current?.focus();
                }
            };

            const skipQuestion = () => {
                setStreak(0);
                generateQuestion();
            };

            const base = question.a;
            const add = question.b % 10;
            const step1 = base + add;
            const step2 = step1 * 10;
            const step3 = (question.a % 10) * (question.b % 10);

            return (
                <div className="max-w-2xl mx-auto space-y-6 animate-fade-in-up">
                    <div className="flex justify-between items-center bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                        <div className="flex flex-col">
                            <span className="text-xs text-slate-500 uppercase font-bold tracking-wider">ÁõÆÂâçÂàÜÊï∏</span>
                            <span className="text-2xl font-black text-indigo-600">{score}</span>
                        </div>
                        <div className="flex flex-col items-end">
                            <span className="text-xs text-slate-500 uppercase font-bold tracking-wider">ÈÄ£Á∫åÁ≠îÂ∞ç</span>
                            <div className="flex items-center gap-1">
                                <span className={`text-2xl font-black ${streak > 2 ? 'text-amber-500' : 'text-slate-400'}`}>
                                    {streak}
                                </span>
                                {streak > 2 && <span className="text-xl">üî•</span>}
                            </div>
                        </div>
                    </div>

                    <div className="bg-white rounded-3xl shadow-lg border border-slate-200 overflow-hidden relative">
                        <div className="p-8 md:p-12 text-center">
                            <div className="text-slate-400 text-sm font-medium mb-4 uppercase tracking-widest">
                                Mental Math Challenge (11-19)
                            </div>
                            <div className="flex items-center justify-center gap-4 text-5xl md:text-7xl font-bold text-slate-800 mb-8 font-mono">
                                <span>{question.a}</span>
                                <span className="text-indigo-400">√ó</span>
                                <span>{question.b}</span>
                                <span className="text-slate-300">=</span>
                                <span className="w-24 md:w-32 border-b-4 border-slate-200 text-indigo-600 min-h-[1em] block">
                                    {gameState === 'correct' ? question.a * question.b : input}
                                </span>
                            </div>

                            <form onSubmit={handleSubmit} className="max-w-xs mx-auto relative">
                                <input
                                    ref={inputRef}
                                    type="number"
                                    value={input}
                                    onChange={(e) => setInput(e.target.value)}
                                    disabled={gameState === 'correct'}
                                    placeholder="?"
                                    className={`
                        w-full text-center text-2xl p-4 rounded-xl border-2 outline-none transition-all shadow-inner
                        ${gameState === 'wrong'
                                            ? 'border-red-400 bg-red-50 text-red-600 animate-shake'
                                            : gameState === 'correct'
                                                ? 'border-green-400 bg-green-50 text-green-600'
                                                : 'border-slate-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10'
                                        }
                      `}
                                />
                                {gameState === 'idle' && (
                                    <button
                                        type="submit"
                                        className="mt-4 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-xl transition-transform active:scale-95 shadow-lg shadow-indigo-200"
                                    >
                                        ÈÄÅÂá∫Á≠îÊ°à
                                    </button>
                                )}
                            </form>

                            <div className="h-16 mt-4 flex items-center justify-center">
                                {gameState === 'correct' && (
                                    <div className="flex items-center gap-2 text-green-600 font-bold text-xl animate-bounce-short">
                                        <Check strokeWidth={3} /> Â§™Ê£í‰∫ÜÔºÅÊ≠£Á¢∫Á≠îÊ°àÔºÅ
                                    </div>
                                )}
                                {gameState === 'wrong' && (
                                    <div className="flex items-center gap-2 text-red-500 font-bold text-lg">
                                        <X strokeWidth={3} /> ÂÜçË©¶‰∏ÄÊ¨°Ôºå‰Ω†ÂèØ‰ª•ÁöÑÔºÅ
                                    </div>
                                )}
                            </div>
                        </div>

                        <div className="bg-slate-50 p-4 border-t border-slate-100 flex justify-between items-center">
                            <button
                                onClick={() => setShowHint(!showHint)}
                                className="flex items-center gap-2 text-indigo-600 font-semibold hover:bg-indigo-50 px-4 py-2 rounded-lg transition-colors text-sm"
                            >
                                <Lightbulb size={18} />
                                {showHint ? 'Èö±ËóèÁßòË®£' : 'ÈÄüÁÆóÁßòË®£'}
                            </button>
                            <button
                                onClick={skipQuestion}
                                className="flex items-center gap-2 text-slate-500 font-medium hover:text-slate-700 hover:bg-slate-100 px-4 py-2 rounded-lg transition-colors text-sm"
                            >
                                <RefreshCw size={16} />
                                Ë∑≥ÈÅéÈÄôÈ°å
                            </button>
                        </div>
                    </div>

                    {showHint && (
                        <div className="bg-amber-50 rounded-2xl p-6 border border-amber-200 animate-fade-in text-slate-700">
                            <h4 className="font-bold text-amber-800 mb-4 flex items-center gap-2">
                                <Calculator size={18} />
                                Âç∞Â∫¶Êï∏Â≠∏ÊãÜËß£Ê≥ï
                            </h4>
                            <div className="flex flex-col gap-3 font-mono text-lg">
                                <div className="flex items-center gap-3">
                                    <span className="bg-white px-2 py-1 rounded border border-amber-200 shadow-sm text-sm text-amber-600 font-sans w-20">Á¨¨‰∏ÄÊ≠•</span>
                                    <span>
                                        Ë¢´‰πòÊï∏ <span className="font-bold">{question.a}</span> + ‰πòÊï∏ÂÄã‰Ωç <span className="font-bold text-blue-600">{add}</span> =
                                        <span className="font-bold ml-2">{step1}</span>
                                    </span>
                                </div>
                                <div className="flex items-center gap-3">
                                    <span className="bg-white px-2 py-1 rounded border border-amber-200 shadow-sm text-sm text-amber-600 font-sans w-20">Á¨¨‰∫åÊ≠•</span>
                                    <span>
                                        ÁµêÊûú √ó 10 = <span className="font-bold ml-2">{step2}</span>
                                    </span>
                                </div>
                                <div className="flex items-center gap-3">
                                    <span className="bg-white px-2 py-1 rounded border border-amber-200 shadow-sm text-sm text-amber-600 font-sans w-20">Á¨¨‰∏âÊ≠•</span>
                                    <span>
                                        ÂÄã‰ΩçÊï∏Áõ∏‰πò (<span className="text-blue-600">{question.a % 10}</span> √ó <span className="text-blue-600">{question.b % 10}</span>) =
                                        <span className="font-bold ml-2">{step3}</span>
                                    </span>
                                </div>
                                <div className="h-px bg-amber-200 my-1"></div>
                                <div className="flex items-center gap-3 text-xl font-bold text-indigo-700">
                                    <span className="bg-indigo-100 px-2 py-1 rounded text-sm text-indigo-700 font-sans w-20 text-center">Á∏ΩÂíå</span>
                                    <span>
                                        {step2} + {step3} = {step2 + step3}
                                    </span>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>